<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student ID Card</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #f5f5f5;
    }

    .id-card {
      background: url('bg.jpg') no-repeat center;
      background-size: cover;
      width: 700px;
      height: 1024px;
      margin: 30px auto;
      padding: 40px 30px;
      position: relative;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      box-sizing: border-box;
      background-color: white;
    }

    .college-name {
      text-align: center;
      color: #d76a00;
      font-weight: bold;
      font-size: 24px;
    }

    .sub-header {
      text-align: center;
      color: #2b2b2b;
      font-size: 18px;
      margin-bottom: 10px;
    }

    .photo {
      width: 160px;
      height: 200px;
      border: 3px solid orange;
      margin: 10px auto;
      display: block;
      object-fit: cover;
    }

    .session {
      text-align: center;
      font-weight: bold;
      margin: 10px 0;
    }

    .student-name {
      text-align: center;
      font-size: 22px;
      color: #0044cc;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .details {
      font-size: 18px;
      padding: 10px 30px;
      line-height: 1.7;
    }

    .label {
      font-weight: bold;
      width: 160px;
      display: inline-block;
    }

    .signature {
      position: absolute;
      bottom: 30px;
      right: 40px;
      font-family: cursive;
      text-align: center;
      color: #004400;
    }

    .error {
      text-align: center;
      margin-top: 100px;
      font-size: 20px;
      color: red;
    }
  </style>
</head>
<body>
  <div class="id-card" id="card">
    <div class="college-name">GOVT. RANI DURGAWATI COLLEGE</div>
    <div class="sub-header">WADRAFNAGAR, BALRAMPUR (C.G.)</div>
    <img id="student-photo" class="photo" src="" alt="Student Photo">
    <div class="session">SESSION 2024â€“25</div>
    <div class="student-name" id="student-name"></div>
    <div class="details">
      <div><span class="label">Father's Name:</span> <span id="fname"></span></div>
      <div><span class="label">Date of Birth:</span> <span id="dob"></span></div>
      <div><span class="label">Admission No.:</span> <span id="admno"></span></div>
      <div><span class="label">Admission Date:</span> <span id="admdt"></span></div>
      <div><span class="label">Address:</span> <span id="address"></span></div>
      <div><span class="label">Dist.:</span> <span id="district"></span></div>
      <div><span class="label">Mobile No.:</span> <span id="mobile"></span></div>
      <div><span class="label">Class:</span> <span id="class"></span></div>
      <div><span class="label">Subjects:</span> <span id="subjects"></span></div>
    </div>
    <div class="signature">
      <strong>Principal</strong><br>
      Govt. Degree College<br>
      Wadrafnagar, Balrampur (C.G.)
    </div>
  </div>

  <div class="error" id="error" style="display:none;">Error fetching data. Please check the URL.</div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const userId = urlParams.get('id');
    const sheetId = '1Ona1thP9bqtVGF4k7F8VGR5RGUKD9l01p-o68k5ziEk';
    const apiKey = 'AIzaSyDFy7OEmx1dj4z2RzPhGA3_b4TNPgcIzEY'; // ðŸ‘ˆ Replace with your real API key
    const sheetName = 'IDCARD'; // ðŸ‘ˆ Replace with your actual sheet name if different
    const apiUrl = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${sheetName}?key=${apiKey}`;

    fetch(apiUrl)
      .then(response => response.json())
      .then(data => {
        const headers = data.values[0];
        const rows = data.values.slice(1);
        const userIndex = headers.indexOf("USER_ID");
        const match = rows.find(row => row[userIndex] === userId);

        if (!match) {
          document.getElementById("card").style.display = "none";
          document.getElementById("error").style.display = "block";
          return;
        }

        const record = {};
        headers.forEach((h, i) => {
          record[h] = match[i];
        });

        document.getElementById("student-name").innerText = record.NAME || "";
        document.getElementById("fname").innerText = record.FNAME || "";
        document.getElementById("dob").innerText = record.DOB || "";
        document.getElementById("admno").innerText = record.ADMNO || "";
        document.getElementById("admdt").innerText = record.ADMDATE || "";
        document.getElementById("address").innerText = record.ADDRESS || "";
        document.getElementById("district").innerText = record.DISTRICT || "";
        document.getElementById("mobile").innerText = record.MOBILE || "";
        document.getElementById("class").innerText = record.CLASS || "";
        document.getElementById("subjects").innerText = record.SUBJECTS || "";

        // Load photo
        const photo = get("PHOTO");
    
        const photoPath = `https://raw.githubusercontent.com/rdcollege/idcard/main/photo/${photo}`;
        document.getElementById("student-photo").src = photoPath;

      })
      .catch(error => {
        document.getElementById("card").style.display = "none";
        document.getElementById("error").style.display = "block";
        console.error(error);
      });
  </script>
</body>
</html>
